<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>汉学研究 (Sinology)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      color-scheme: light dark;
    }
    .hero {
      background-image: url('assets/images/banner.jpg');
      background-size: cover;
      background-position: center;
    }
    .backdrop {
      background: linear-gradient(rgba(17,24,39,.55), rgba(17,24,39,.55));
    }
    .card { transition: box-shadow .15s ease, transform .03s ease; }
    .card:hover { box-shadow: 0 6px 24px rgba(0,0,0,.08); transform: translateY(1px); }
  </style>
</head>
<body class="bg-stone-50 text-stone-900">
  <!-- Top bar -->
  <nav class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-stone-200">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <h1 class="text-2xl md:text-4xl font-extrabold tracking-tight">汉学研究 (Sinology)</h1>
      </div>
      <div class="flex items-center gap-3">
        <img src="assets/images/logo.png" alt="Logo" class="h-10 w-auto"/>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <header class="hero">
    <div class="backdrop">
      <div class="max-w-6xl mx-auto px-4 py-16 md:py-24">
        <p class="text-stone-100/90 text-lg md:text-xl max-w-3xl">探索中西文化交流的桥梁 · 在此汇聚世界各地的汉学研究者与资料。</p>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-10">
    <!-- Intro (保留简要介绍，色调收敛) -->
    <section id="intro" class="mb-10">
      <div class="bg-white border border-stone-200 rounded-xl p-6 card">
        <h2 class="text-xl font-semibold mb-3">什么是汉学？</h2>
        <p class="text-stone-700">汉学 (Sinology) 指在中国以外地区对中国语言、文学、历史、思想、艺术等方面进行的学术研究，强调跨文化、多学科的学术视野。</p>
      </div>
    </section>

    <!-- 学者索引（已嵌入首页） -->
    <section id="people" class="mb-12">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-4 mb-4">
        <div>
          <h2 class="text-xl font-semibold">学者索引</h2>
          <p class="text-stone-600 text-sm">数据来源：<a class="underline" href="https://en.wikipedia.org/wiki/List_of_sinologists" target="_blank" rel="noopener">List of sinologists</a></p>
        </div>
        <div class="flex items-center gap-3">
          <input id="q" type="search" placeholder="搜索姓名（支持片段）" class="w-72 border border-stone-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-stone-300"/>
        </div>
      </div>

      <div class="grid md:grid-cols-3 gap-4 mb-4">
        <div class="bg-white border border-stone-200 rounded-xl p-4">
          <div class="text-sm text-stone-500">总人数</div>
          <div id="totalCount" class="text-3xl font-bold mt-1">0</div>
        </div>
        <div class="md:col-span-2 bg-white border border-stone-200 rounded-xl p-4">
          <div class="text-sm text-stone-500 mb-2">首字母分布</div>
          <div id="initialBars" class="grid grid-cols-13 gap-1 items-end" aria-label="首字母分布图"></div>
          <div class="mt-2 text-xs text-stone-500">A–Z 及其他</div>
        </div>
      </div>

      <ul id="list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2"></ul>
      <div id="count" class="text-stone-600 text-sm mt-3"></div>
    </section>

    <!-- History (保留) -->
    <section id="history" class="mb-12">
      <div class="bg-white border border-stone-200 rounded-xl p-6 card">
        <h2 class="text-xl font-semibold mb-3">汉学发展史 (概览)</h2>
        <div class="grid md:grid-cols-4 gap-4 text-sm text-stone-700">
          <div><div class="font-medium">16–17世纪</div><div class="text-stone-600">传教士时期</div></div>
          <div><div class="font-medium">18–19世纪</div><div class="text-stone-600">学院派兴起</div></div>
          <div><div class="font-medium">20世纪</div><div class="text-stone-600">现代汉学</div></div>
          <div><div class="font-medium">21世纪</div><div class="text-stone-600">全球化与跨学科</div></div>
        </div>
      </div>
    </section>

    <!-- Research fields (保留) -->
    <section id="fields" class="mb-16">
      <div class="bg-white border border-stone-200 rounded-xl p-6 card">
        <h2 class="text-xl font-semibold mb-3">研究领域</h2>
        <ul class="grid md:grid-cols-4 gap-3 text-sm text-stone-700">
          <li>语言文字学</li>
          <li>哲学思想</li>
          <li>历史研究</li>
          <li>艺术文学</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="border-t border-stone-200 bg-white/70">
    <div class="max-w-6xl mx-auto px-4 py-8 text-center text-stone-600 text-sm">
      探索汉学，连接东西方文明 · 许可与归属见 <a class="underline" href="attribution.html">Attribution</a>
    </div>
  </footer>

  <script>
    function escapeRegExp(str){return str.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');}
    function debounce(fn,delay){let t; return (...a)=>{clearTimeout(t); t=setTimeout(()=>fn(...a),delay)}}
    function initialKey(name){
      const n=(name||'').trim();
      const m=n.match(/[A-Za-z]/);
      if(!m) return '#';
      return m[0].toUpperCase();
    }

    async function main(){
      const res = await fetch('manifest.json');
      const data = await res.json();
      const items = data.map(x=>({ name:x.name, file:(x.file||'').split('/').pop(), url:'people/'+(x.file||'').split('/').pop() }))
                        .filter(x=>x.name && x.url);

      // Stats
      document.getElementById('totalCount').textContent = items.length.toString();
      const dist = new Map();
      for(const i of items){ const k=initialKey(i.name); dist.set(k,(dist.get(k)||0)+1); }
      const letters = [...'ABCDEFGHIJKLMNOPQRSTUVWXYZ', '#'];
      const max = Math.max(...letters.map(l=>dist.get(l)||0), 1);
      const bars = document.getElementById('initialBars');
      bars.innerHTML = '';
      letters.forEach(l=>{
        const v = dist.get(l)||0;
        const h = Math.round((v/max)*80)+10; // 10-90px
        const wrap=document.createElement('div'); wrap.className='flex flex-col items-center gap-1';
        const bar=document.createElement('div'); bar.style.height=h+'px'; bar.title=`${l}: ${v}`;
        bar.className='w-4 bg-stone-400/70 hover:bg-stone-600 rounded';
        const lab=document.createElement('div'); lab.className='text-[10px] text-stone-500'; lab.textContent=l;
        wrap.appendChild(bar); wrap.appendChild(lab); bars.appendChild(wrap);
      });

      // List
      const list = document.getElementById('list');
      const q = document.getElementById('q');
      const count = document.getElementById('count');

      function render(filter=''){
        const t = filter.trim().toLowerCase();
        const filtered = t ? items.filter(i=>i.name.toLowerCase().includes(t)) : items;
        count.textContent = `当前显示 ${filtered.length} / 共 ${items.length}`;
        const frag=document.createDocumentFragment();
        filtered.forEach(i=>{
          const li=document.createElement('li');
          const a=document.createElement('a'); a.href=i.url; a.target='_blank'; a.rel='noopener';
          a.className='block border border-stone-200 bg-white rounded-lg px-4 py-3 hover:border-stone-400';
          if(t){ const re=new RegExp(escapeRegExp(t),'ig'); a.innerHTML=i.name.replace(re,m=>`<mark class="bg-yellow-200">${m}</mark>`); }
          else { a.textContent=i.name; }
          li.appendChild(a); frag.appendChild(li);
        });
        list.innerHTML=''; list.appendChild(frag);
      }

      q.addEventListener('input', debounce(()=>render(q.value), 150));
      render('');
    }
    main().catch(console.error);
  </script>
</body>
</html>
